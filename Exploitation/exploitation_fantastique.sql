--EXERCICE: Exploitation de Donnees en SQL

--Question 01 
/*
SELECT d.JDS, count(*) AS Qte
FROM f_dw_vente v,f_dw_date d
WHERE v.TICKET_DATE = d.TRADE_DATE
GROUP BY d.JDS
ORDER BY Qte DESC;
*/


--Question 02
/*
SELECT ROUND(avg(Qte))
FROM 
(
	SELECT d.JDS AS jds, COUNT(*) AS Qte
	FROM f_dw_vente v, f_dw_date d
	WHERE v.TICKET_DATE = d.TRADE_DATE
	GROUP BY jds
	ORDER BY Qte DESC
) 
WHERE jds <> 'saturday';
*/

--Question 03

--Creation of view
/*
CREATE OR REPLACE VIEW vente_jds(JDS, Qte)
AS
	SELECT d.JDS, count(*) AS Qte
	FROM f_dw_vente v,f_dw_date d
	WHERE v.TICKET_DATE = d.TRADE_DATE
	GROUP BY d.JDS
	ORDER BY Qte DESC;

CREATE OR REPLACE VIEW vente_moyen_hor_semadi(Moyen)
AS
	SELECT avg(Qte)
	FROM 
	(
		SELECT d.JDS AS jds, COUNT(*) AS Qte
		FROM f_dw_vente v, f_dw_date d
		WHERE v.TICKET_DATE = d.TRADE_DATE
		GROUP BY jds
		ORDER BY Qte DESC
	) 
	WHERE jds <> 'saturday';

CREATE OR REPLACE VIEW ratio_samedi_par_moyene(JDS,Ratio)
AS
(
  SELECT jds.JDS, (jds.Qte/hs.Moyen) AS moyen
  FROM vente_jds jds, vente_moyen_hor_semadi hs
  WHERE jds.JDS = 'saturday'
);
*/

--Question 04 
/*
SELECT m.Rayonnage, COUNT(*) AS Qte
FROM f_dw_vente v,f_dw_magasin m 
WHERE v.SHOP = m.Magasin_Id
GROUP BY m.Rayonnage;


SELECT m.Rayonnage, COUNT(*) AS nombre
FROM f_dw_magasin m
GROUP BY m.Rayonnage;
*/

/*
SELECT r1,Qte, nombre, ROUND(Qte/nombre) AS Ratio
FROM 
(SELECT m.Rayonnage AS r1, COUNT(*) AS Qte
FROM f_dw_vente v,f_dw_magasin m 
WHERE v.SHOP = m.Magasin_Id
GROUP BY m.Rayonnage),
(SELECT m.Rayonnage AS r2, COUNT(*) AS nombre
FROM f_dw_magasin m
GROUP BY m.Rayonnage
)
WHERE r1 = r2
ORDER BY Ratio DESC;
*/

--Question 05
/*
CREATE OR REPLACE VIEW Qte_Par_Semaine(Semaine, Qte)
AS
	SELECT d.SEMAINE, COUNT(*) AS Qte
	FROM f_dw_vente v, f_dw_date d
	WHERE v.TICKET_DATE = d.TRADE_DATE 
	GROUP BY d.SEMAINE
	ORDER BY d.SEMAINE;


SET echo off 
SET termout off
SET feedback off
SET heading off
SET PAGESIZE 0
SPOOL ./Results/venteParsem.csv
SELECT * FROM Qte_Par_Semaine;
SPOOL off
*/


--EXERCICE EXPLOIATION DE DONNEES AVEC ORACLE ET OOo Calc
























